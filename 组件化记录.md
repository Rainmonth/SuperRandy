---
title: Android组件化记录
categories:
- Android
tags:
- 组件化
---

## 摘要

本文主要记录个人项目SuperRandy组件化的演进过程。

<!--more-->



## 模块分离

- app，壳子module
- common，基础库module
- common-res，基础库资源module，只放公用资源文件
- component-app，应用介绍module
- component-music，音乐module
- component-read，阅读module
- component-movie，电影module

## module包结构

- api，数据请求API

- base，当前module基础依赖

- di，Dagger相关文件

- mvp

  - contract

  - model

  - presenter

  - ui

    - activity

    - fragment

    - adapter

      ...



## 注意的问题

### ButterKnife

- 为了项目独立运行或作为一个组件运行这两中状态下切换的方便性，建议组件module中不要使用ButterKnife，同时组件中多个控件的点击事件的相应问题
  - 采用多重if判断（而不是switch语句）来实现；
  - 每个空间单独设置setOnClickListener(new View.OnClickListener()) 来实现；

### ARouter

- ARouter在使用前，一定要记得初始化；

- ARouter在使用是，要做如下配置：

  ```groovy
  android {
  	...
      defaultConfig {
          ...
          javaCompileOptions {
              annotationProcessorOptions {
  //                includeCompileClasspath true
                  // 这个一定要添加
                  arguments = [moduleName: project.getName()]
              }
          }
          ...
      }
  }
  dependencies {
      // 这两个一定要添加，而且是所用使用了ARouter 的Module都要添加
      compile(rootProject.ext.dependencies["router"]){
          exclude module: 'support-v4'
          exclude module: 'appcompat-v7'
          exclude module: 'support-annotations'
      }
      annotationProcessor rootProject.ext.dependencies["router-compiler"]
  }
  ```

  

- 使用ARouter在Module间跳转：
  - 主Module调到Library Module的页面，Library Module一定要添加到主Module的依赖中；
  - Library Module调到Library Module的页面（二者不需要彼此添加依赖）